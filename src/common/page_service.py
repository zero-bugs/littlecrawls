9iaW4vcHl0aG9uMwojIC0qLSBjb2Rpbmc6IFVURi04IC0qLQppbXBvcnQgZGF0ZXRpbWUKCmZyb20gc3JjLmNvbW1vbi5jb21tb25fY29uZmlnIGltcG9ydCBDb21tb25Db25zdGFudApmcm9tIHNyYy5kYi5zcV9jb25uZWN0aW9uIGltcG9ydCBzcWxpdGVNYW5hZ2VyCmZyb20gc3JjLnV0aWxzLmh0dHBfdXRpbHMgaW1wb3J0IEh0dHBDbGllbnQsIGh0dHBDbGllbnQKZnJvbSBiczQgaW1wb3J0IEJlYXV0aWZ1bFNvdXAKCgpjbGFzcyBJbWdTZXJ2aWNlUGFnZToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHN0YXJ0U2VhcmNoVXNlUGFnZShzZWxmLCB1cmwsIHBhZ2U9MSk6CiAgICAgICAgaWYgcGFnZSA+IDE6CiAgICAgICAgICAgIHVybCArPSAnJnBhZ2U9e30nLmZvcm1hdChwYWdlKQogICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICd1c2VyLWFnZW50JzoKICAgICAgICAgICAgICAgICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvODYuMC40MjQwLjc1IFNhZmFyaS81MzcuMzYgJywKICAgICAgICAgICAgJ29yaWdpbic6ICJ7fSIuZm9ybWF0KENvbW1vbkNvbnN0YW50LndhbGxfaGF2ZW5fdXJsKSwKICAgICAgICAgICAgJ2FjY2VwdCc6CiAgICAgICAgICAgICAgICAndGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2UvYXZpZixpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44LGFwcGxpY2F0aW9uL3NpZ25lZC1leGNoYW5nZTt2PWIzO3E9MC45JwogICAgICAgIH0KCiAgICAgICAgcmVzcCA9IGh0dHBDbGllbnQuaHR0cF9yZXRyeV9leGVjdXRvcih1cmwsIGhlYWRlcnMsIHVzZUNvb2tpZT1UcnVlKQogICAgICAgIGlmIHJlc3Auc3RhdHVzX2NvZGUgIT0gMjAwOgogICAgICAgICAgICBwcmludCgiaHR0cCByZXF1ZXN0IGV4Y2VwdGlvbiwgY29kZTp7fSwgdXJsOnt9Ii5mb3JtYXQocmVzcC5zdGF0dXNfY29kZSwgdXJsKSkKCiAgICAgICAgc291cCA9IEJlYXV0aWZ1bFNvdXAocmVzcC50ZXh0LCAnaHRtbC5wYXJzZXInKQoKICAgIGRlZiBzdGFydFNlYXJjaFRvcExpc3RQaWMoc2VsZik6CiAgICAgICAgc2VsZi5zdGFydFNlYXJjaFVzZVBhZ2UoCiAgICAgICAgICAgICdodHRwczovL3dhbGxoYXZlbi5jYy9zZWFyY2g/Y2F0ZWdvcmllcz0xMTEmcHVyaXR5PTAxMCZ0b3BSYW5nZT0xTSZzb3J0aW5nPXRvcGxpc3Qmb3JkZXI9ZGVzYycpCgIyAhL3Vzci
